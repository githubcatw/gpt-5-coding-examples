(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1057:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>x});var i=l(5155),a=l(2115);function o(e,t){return Math.random()*(t-e)+e}function n(e,t){return Math.floor(o(e,t))}function s(e,t,l){return Math.max(t,Math.min(l,e))}function r(e){return Math.hypot(e.x,e.y)}function f(e){let t=r(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}}function d(e,t){return{x:e.x+t.x,y:e.y+t.y}}function c(e,t){return{x:e.x*t,y:e.y*t}}function h(e,t){let l=Math.cos(t),i=Math.sin(t);return{x:e.x*l-e.y*i,y:e.x*i+e.y*l}}function u(e){return(e=(e+Math.PI)%(2*Math.PI))<0&&(e+=2*Math.PI),e-Math.PI}function p(e,t,l){let i=u(t-e);return e+(i=s(i,-l,l))}class m{ensure(){if(!this.ctx){let e=window.AudioContext||window.webkitAudioContext;e&&(this.ctx=new e,this.master=this.ctx.createGain(),this.master.gain.value=.15,this.master.connect(this.ctx.destination))}}async resume(){if(this.ensure(),this.ctx)try{"running"!==this.ctx.state&&this.ctx.resume&&await this.ctx.resume()}catch(e){}}blip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:440,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sine",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.2;if(!this.ctx||!this.master)return;let a=this.ctx.currentTime,o=this.ctx.createOscillator(),n=this.ctx.createGain();o.type=l,o.frequency.value=e,n.gain.setValueAtTime(i,a),n.gain.exponentialRampToValueAtTime(.001,a+t),o.connect(n),n.connect(this.master),o.start(a),o.stop(a+t)}sweep(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.18,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sawtooth",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2;if(!this.ctx||!this.master)return;let o=this.ctx.currentTime,n=this.ctx.createOscillator(),s=this.ctx.createGain();n.type=i,n.frequency.setValueAtTime(e,o),n.frequency.exponentialRampToValueAtTime(t,o+l),s.gain.setValueAtTime(a,o),s.gain.exponentialRampToValueAtTime(.001,o+l),n.connect(s),s.connect(this.master),n.start(o),n.stop(o+l)}laser(){this.sweep(900,300,.08,"sawtooth",.18)}missile(){this.sweep(600,100,.2,"triangle",.22)}explode(){if(!this.ctx||!this.master)return;let e=this.ctx.currentTime,t=2*this.ctx.sampleRate*.25,l=this.ctx.createBuffer(1,t,this.ctx.sampleRate),i=l.getChannelData(0);for(let e=0;e<t;e++)i[e]=(2*Math.random()-1)*Math.pow(1-e/t,2);let a=this.ctx.createBufferSource();a.buffer=l;let o=this.ctx.createBiquadFilter();o.type="lowpass",o.frequency.setValueAtTime(1200,e),o.frequency.exponentialRampToValueAtTime(200,e+.25);let n=this.ctx.createGain();n.gain.setValueAtTime(.7,e),n.gain.exponentialRampToValueAtTime(.001,e+.25),a.connect(o),o.connect(n),n.connect(this.master),a.start(e),a.stop(e+.25)}pickup(){this.sweep(400,800,.12,"square",.15)}hurt(){this.blip(120,.1,"square",.3)}boost(){this.sweep(200,600,.12,"sawtooth",.12)}constructor(){this.ctx=null,this.master=null,this.started=!1}}function x(){let e=(0,a.useRef)(null),[t,l]=(0,a.useState)(!1),[x,y]=(0,a.useState)(!0),[g,v]=(0,a.useState)(!1),T=(0,a.useRef)(new m);return(0,a.useEffect)(()=>{let l=e.current;if(!l)return;let i=l.getContext("2d");if(!i)return;let a=T.current;a.ensure();let m={},S={x:0,y:0,down:!1},w=Math.max(1,window.devicePixelRatio||1),k=window.innerWidth,M=window.innerHeight;function b(){w=Math.max(1,window.devicePixelRatio||1),k=window.innerWidth,M=window.innerHeight,l.width=Math.floor(k*w),l.height=Math.floor(M*w),l.style.width=k+"px",l.style.height=M+"px",(i=l.getContext("2d"))&&i.setTransform(w,0,0,w,0,0)}function R(e,t,l){let i=e-t;return i>l/2&&(i-=l),i<-l/2&&(i+=l),i}function P(e){return{x:(e.x%6e3+6e3)%6e3,y:(e.y%6e3+6e3)%6e3}}function A(e,t){return{x:R(e.x,t.x,6e3),y:R(e.y,t.y,6e3)}}function E(e,t){let l=A(e,t);return l.x*l.x+l.y*l.y}b();let C={pos:{x:3e3,y:3e3},shake:0},L=1,V=[],U=[],I=[],W=[],F=[],q=[],z=[],H=[],O=[];function B(){z.length=0,H.length=0,O.length=0;for(let e=0;e<180;e++)z.push({x:6e3*Math.random(),y:6e3*Math.random(),r:+Math.random()+.2,a:o(.2,.6)});for(let e=0;e<140;e++)H.push({x:6e3*Math.random(),y:6e3*Math.random(),r:1.7*Math.random()+.4,a:o(.3,.8)});for(let e=0;e<90;e++)O.push({x:6e3*Math.random(),y:6e3*Math.random(),r:2*Math.random()+.5,a:o(.4,.9)})}B();let j={id:L++,faction:"player",model:"KESTREL",pos:{x:3e3,y:3e3},vel:{x:0,y:0},angle:0,turnRate:3.4,accel:600,maxSpeed:700,radius:14,shield:100,maxShield:100,shieldRegen:10,hull:100,maxHull:100,fireCooldown:0,missileCooldown:0,missileAmmo:6,alive:!0,name:"Kestrel",heat:0,color:"#4ef0ff",scoreValue:0};V.push(j);let G={score:0,time:0,mouseAim:!0,difficulty:1,killStreak:0,bestStreak:0,credits:0,pirateSpawnTimer:0,asteroidSpawnTimer:0,gameOver:!1};function D(){U.length=0,I.length=0,W.length=0,F.length=0,q.length=0;for(let e=V.length-1;e>=0;e--)"player"!==V[e].faction&&V.splice(e,1);j.pos={x:3e3,y:3e3},j.vel={x:0,y:0},j.angle=0,j.shield=j.maxShield,j.hull=j.maxHull,j.missileAmmo=6,j.alive=!0,G.score=0,G.time=0,G.difficulty=1,G.killStreak=0,G.bestStreak=0,G.credits=0,G.pirateSpawnTimer=0,G.asteroidSpawnTimer=0,G.gameOver=!1,C.pos={x:j.pos.x,y:j.pos.y},B();for(let e=0;e<24;e++)_(3);for(let e=0;e<3;e++)N()}function _(e,t,l){let i=3===e?o(48,68):2===e?o(28,40):o(16,22),a={id:L++,pos:null!=t?t:P({x:6e3*Math.random(),y:6e3*Math.random()}),vel:null!=l?l:function(){let t=Math.random()*Math.PI*2,l=o(20,60)/e;return{x:Math.cos(t)*l,y:Math.sin(t)*l}}(),radius:i,hp:1.5*i+10*e,angle:Math.random()*Math.PI*2,spin:o(-.7,.7),size:e,shape:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14,l=[],i=99991*e+17;for(let e=0;e<t;e++){let e=.8+(i=48271*i%0x7fffffff)%1e3/1e3*.5;l.push(e)}return l}(n(0,1e5),n(10,18))};return W.push(a),a}function N(){let e,t=n(0,4);e=0===t?{x:o(0,6e3),y:0}:1===t?{x:o(0,6e3),y:6e3}:2===t?{x:0,y:o(0,6e3)}:{x:6e3,y:o(0,6e3)};let l=.5>Math.random()?"VULTURE":"WASP",i={id:L++,faction:"pirate",model:l,pos:P(e),vel:{x:0,y:0},angle:Math.random()*Math.PI*2,turnRate:"VULTURE"===l?2.6:3.8,accel:"VULTURE"===l?520:680,maxSpeed:"VULTURE"===l?620:760,radius:"VULTURE"===l?16:12,shield:"VULTURE"===l?90:60,maxShield:"VULTURE"===l?90:60,shieldRegen:"VULTURE"===l?8:12,hull:"VULTURE"===l?100:70,maxHull:"VULTURE"===l?100:70,fireCooldown:0,missileCooldown:2,missileAmmo:n(1,3),alive:!0,name:"VULTURE"===l?"Vulture":"Wasp",heat:0,color:"VULTURE"===l?"#ffa14e":"#ff4ea8",scoreValue:"VULTURE"===l?120:100,ai:{state:"attack",patience:o(4,10),strafeTimer:o(.5,2.5)}};return V.push(i),i}function K(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba(255,200,60,";for(let l=0;l<40;l++){let l=Math.random()*Math.PI*2,i=o(60,420),a={id:L++,pos:{x:e.x,y:e.y},vel:{x:Math.cos(l)*i,y:Math.sin(l)*i},life:o(.4,.9),maxLife:.9,size:o(2,5),color:t+o(.3,.9)+")",fade:!0};F.push(a)}C.shake=Math.max(C.shake,10),a.explode()}function Q(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgba(120,220,255,";for(let i=0;i<14;i++){let i=h(t,o(-.6,.6)),a=o(120,200),n={id:L++,pos:{x:e.x,y:e.y},vel:{x:i.x*a,y:i.y*a},life:o(.2,.4),maxLife:.4,size:o(1.5,3),color:l+o(.3,.8)+")",fade:!0};F.push(n)}}function J(e){let t=Math.random(),l="credits",i="credits"==(l=t<.25?"repair":t<.5?"shield":t<.7?"missiles":"credits")?n(10,50):"missiles"===l?n(1,3):n(15,40),a={id:L++,pos:{x:e.x,y:e.y},vel:{x:o(-30,30),y:o(-30,30)},radius:10,type:l,amount:i,life:12,spin:o(-2,2),color:"credits"===l?"#ffd24e":"missiles"===l?"#ff6ec7":"shield"===l?"#4effa8":"#4ecbff"};q.push(a)}function X(e){let t=r(e.vel),l="player"===e.faction?.02:.03,i=900+.2*t;for(let t of(h({x:0,y:-8},e.angle),h({x:0,y:8},e.angle),[d(e.pos,h({x:e.radius+4,y:-4},e.angle)),d(e.pos,h({x:e.radius+4,y:4},e.angle))])){let a={x:Math.cos(e.angle+o(-l,l)),y:Math.sin(e.angle+o(-l,l))},n={id:L++,pos:P({x:t.x,y:t.y}),vel:d(c(a,i),e.vel),life:.8,dmg:"player"===e.faction?16:12,radius:3,color:"player"===e.faction?"#6cf3ff":"#ff9b4e",ownerId:e.id,faction:e.faction};U.push(n)}"player"===e.faction&&a.laser()}function Y(e,t){if(e.missileAmmo<=0)return;let l={x:Math.cos(e.angle),y:Math.sin(e.angle)},i={id:L++,pos:P(d(e.pos,c(l,e.radius+10))),vel:d(e.vel,c(l,200)),life:4.5,dmg:55,radius:5,ownerId:e.id,faction:e.faction,targetId:t,turnRate:3.8,accel:360,maxSpeed:780,trail:0};I.push(i),e.missileAmmo-=1,e.missileCooldown=.7,"player"===e.faction&&a.missile()}function Z(e,t,l){e.shield;let i=Math.min(e.shield,t);e.shield-=i,t-=i,i>0&&Q(e.pos,f(l||{x:o(-1,1),y:o(-1,1)}),"rgba(120,220,255,"),t>0&&(e.hull-=t,Q(e.pos,f(l||{x:o(-1,1),y:o(-1,1)}),"rgba(255,140,60,"),"player"===e.faction&&(a.hurt(),G.killStreak=0)),l&&(e.vel=d(e.vel,c(f(l),40))),e.hull<=0&&e.alive&&(e.alive=!1,K(e.pos,"rgba(255,190,80,"),C.shake=Math.max(C.shake,20),"pirate"===e.faction&&(G.score+=e.scoreValue,G.killStreak+=1,G.bestStreak=Math.max(G.bestStreak,G.killStreak),.8>Math.random()&&J(e.pos)),"player"===e.faction&&(G.gameOver=!0))}function $(e){if(e.size>1){let t=n(2,3);for(let l=0;l<t;l++){let t=Math.random()*Math.PI*2,l=o(40,120);_(e.size-1,e.pos,{x:Math.cos(t)*l,y:Math.sin(t)*l})}}.35>Math.random()&&J(e.pos)}function ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:900,l=null,i=t*t;for(let t of V){if(!t.alive||t.id===e.id||t.faction===e.faction)continue;let a=E(t.pos,e.pos);a<i&&(i=a,l=t)}return l}function et(e){m[e.key.toLowerCase()]=!0,(" "===e.key||"Spacebar"===e.key)&&e.preventDefault(),("p"===e.key||"P"===e.key||"Escape"===e.key)&&v(e=>!e),("m"===e.key||"M"===e.key)&&(G.mouseAim=!G.mouseAim),"h"!==e.key&&"H"!==e.key||G.gameOver||y(e=>!e),("r"===e.key||"R"===e.key)&&G.gameOver&&D()}function el(e){m[e.key.toLowerCase()]=!1}function ei(e){let t=l.getBoundingClientRect();S.x=e.clientX-t.left,S.y=e.clientY-t.top}function ea(){S.down=!0}function eo(){S.down=!1}D(),window.addEventListener("resize",b),window.addEventListener("keydown",et),window.addEventListener("keyup",el),window.addEventListener("mousemove",ei),window.addEventListener("mousedown",ea),window.addEventListener("mouseup",eo);let en=performance.now(),es=0;function er(e){let t=R(e.x,C.pos.x,6e3),l=R(e.y,C.pos.y,6e3),i=k/2+t,a=M/2+l;return C.shake>0&&(i+=o(-C.shake,C.shake),a+=o(-C.shake,C.shake)),{x:i,y:a}}function ef(e,t,l,i){let a=C.pos;for(let o of t){let t=((o.x-a.x*l+6e3)%6e3+6e3)%6e3,n=((o.y-a.y*l+6e3)%6e3+6e3)%6e3;for(let s=-1;s<=1;s++)for(let r=-1;r<=1;r++){let f=t+6e3*s-(k/2-a.x*(1-l)),d=n+6e3*r-(M/2-a.y*(1-l));f<-10||d<-10||f>k+10||d>M+10||(e.globalAlpha=o.a,e.fillStyle=i,e.beginPath(),e.arc(f,d,o.r,0,2*Math.PI),e.fill(),e.globalAlpha=1)}}}return es=requestAnimationFrame(function e(l){es=requestAnimationFrame(e);let h=(l-en)/1e3;h>.05&&(h=.05),en=l,!g&&t&&function(e){if(G.time+=e,!j.alive,G.difficulty=1+Math.min(2.5,G.time/120),G.asteroidSpawnTimer-=e,G.asteroidSpawnTimer<=0&&W.length<80&&(_(n(2,3)),G.asteroidSpawnTimer=o(1,2.5)/G.difficulty),G.pirateSpawnTimer-=e,G.pirateSpawnTimer<=0&&V.filter(e=>"pirate"===e.faction&&e.alive).length<6*G.difficulty&&(N(),G.pirateSpawnTimer=o(3,6)/Math.sqrt(G.difficulty)),j.alive){let t=0,l=0,i=0;(m.w||m.arrowup)&&(t=1),(m.s||m.arrowdown)&&(l=1),m.q&&(i-=1),m.e&&(i+=1);let o=m.shift,n=j.accel*(o?1.5:1),h=j.maxSpeed*(o?1.1:1);o&&a.boost();let u=j.angle;if(G.mouseAim){let e=C.pos,t=R(e.x+(S.x-k/2),j.pos.x,6e3);u=Math.atan2(R(e.y+(S.y-M/2),j.pos.y,6e3),t)}else(m.a||m.arrowleft)&&(j.angle-=j.turnRate*e),(m.d||m.arrowright)&&(j.angle+=j.turnRate*e);G.mouseAim&&(j.angle=p(j.angle,u,j.turnRate*e));let x={x:Math.cos(j.angle),y:Math.sin(j.angle)},y={x:x.y,y:-x.x},g={x:0,y:0};if(g=d(g,c(x,t*n)),g=d(g,c(x,-l*n*.8)),g=d(g,c(y,i*n*.7)),j.vel=d(j.vel,c(g,e)),j.vel=c(j.vel,.996),r(j.vel)>h&&(j.vel=c(f(j.vel),h)),j.pos=P(d(j.pos,c(j.vel,e))),j.heat=s(j.heat+(t+l+Math.abs(i))*e*3-2*e,0,1),j.fireCooldown-=e,j.missileCooldown-=e,(m[" "]||S.down)&&j.fireCooldown<=0&&(X(j),j.fireCooldown=.12),m.f&&j.missileCooldown<=0&&j.missileAmmo>0){let e=ee(j,900);Y(j,e?e.id:null)}}for(let t of V){if(!t.alive||"pirate"!==t.faction||!t.ai)continue;let l=t.ai;l.patience-=e,l.strafeTimer-=e;let i=j.alive?j:null;if(!i)continue;let a=A(i.pos,t.pos),n=Math.hypot(a.x,a.y),h=Math.atan2(a.y,a.x),m={x:0,y:0};for(let e of W){let l=A(e.pos,t.pos),i=Math.hypot(l.x,l.y);if(i<e.radius+180){let t=(e.radius+180-i)/(e.radius+180);m=d(m,c(f({x:-l.x,y:-l.y}),280*t))}}let x=d(c(f(a),1),c(f(m),1.5)),y=Math.atan2(x.y,x.x);t.angle=p(t.angle,y,t.turnRate*e);let g={x:Math.cos(t.angle),y:Math.sin(t.angle)},v=t.accel*(n>200?1:.5);if(l.strafeTimer<=0){l.strafeTimer=o(.6,1.8);let e=.5>Math.random()?-1:1;t.vel=d(t.vel,c({x:g.y,y:-g.x},60*e))}t.vel=d(t.vel,c(g,v*e)),t.vel=c(t.vel,.996),r(t.vel)>t.maxSpeed&&(t.vel=c(f(t.vel),t.maxSpeed)),t.pos=P(d(t.pos,c(t.vel,e))),t.heat=s(t.heat+2*e-1.5*e,0,1),t.fireCooldown-=e,t.missileCooldown-=e;let T=Math.abs(u(h-t.angle));n<650&&T<.25&&t.fireCooldown<=0&&(X(t),t.fireCooldown=.16+.05*Math.random()),n<700&&T<.4&&t.missileCooldown<=0&&t.missileAmmo>0&&.4>Math.random()&&Y(t,i.id)}for(let t=U.length-1;t>=0;t--){let l=U[t];if(l.life-=e,l.life<=0){U.splice(t,1);continue}for(let i of(l.pos=P(d(l.pos,c(l.vel,e))),V)){if(!i.alive||i.faction===l.faction||i.id===l.ownerId)continue;let e=E(l.pos,i.pos),a=i.radius+l.radius+2;if(e<=a*a){Z(i,l.dmg,l.vel),Q(l.pos,f(l.vel),"rgba(255,180,80,"),U.splice(t,1);break}}for(let e=W.length-1;e>=0&&t<U.length;e--){let i=W[e],a=E(l.pos,i.pos),o=i.radius+l.radius;if(a<=o*o){i.hp-=l.dmg,Q(l.pos,f(l.vel),"rgba(200,220,255,"),U.splice(t,1),i.hp<=0&&(K(i.pos),"player"===l.faction&&(G.score+=3===i.size?30:2===i.size?20:10,G.killStreak+=1,G.bestStreak=Math.max(G.bestStreak,G.killStreak)),$(i),W.splice(e,1));break}}}for(let t=I.length-1;t>=0;t--){let l=I[t];if(l.life-=e,l.life<=0){I.splice(t,1);continue}let i=null;if(l.targetId&&(i=V.find(e=>e.id===l.targetId&&e.alive&&e.faction!==l.faction)||null),!i){let e=V.find(e=>e.id===l.ownerId),t=(null==e?void 0:e.faction)||l.faction,a=null,o=49e4;for(let e of V){if(!e.alive||e.faction===t)continue;let i=E(e.pos,l.pos);i<o&&(o=i,a=e)}l.targetId=(i=a)?i.id:null}let a=f(l.vel),o=a;if(i){let t=A(i.pos,l.pos),n=Math.atan2(t.y,t.x),s=p(Math.atan2(a.y,a.x),n,l.turnRate*e);o={x:Math.cos(s),y:Math.sin(s)}}for(let i of(l.vel=d(l.vel,c(o,l.accel*e)),r(l.vel)>l.maxSpeed&&(l.vel=c(f(l.vel),l.maxSpeed)),l.pos=P(d(l.pos,c(l.vel,e))),l.trail+=e,V))if(i.alive&&i.faction!==l.faction&&E(l.pos,i.pos)<(i.radius+l.radius)*(i.radius+l.radius)){Z(i,l.dmg,l.vel),K(l.pos),I.splice(t,1);break}for(let e=W.length-1;e>=0&&t<I.length;e--){let i=W[e];if(E(l.pos,i.pos)<(i.radius+l.radius)*(i.radius+l.radius)){i.hp-=l.dmg,K(l.pos),I.splice(t,1),i.hp<=0&&(K(i.pos),.35>Math.random()&&J(i.pos),W.splice(e,1));break}}}for(let e of V)if(e.alive)for(let a of W){let o=A(e.pos,a.pos),n=Math.hypot(o.x,o.y),s=e.radius+a.radius;if(n<s){var t,l,i;let r=0===n?{x:1,y:0}:{x:o.x/n,y:o.y/n},f=s-n;e.pos=P(d(e.pos,c(r,.5*f))),a.pos=P(d(a.pos,c(r,-(.5*f))));let h=(t=e.vel,l=a.vel,i={x:t.x-l.x,y:t.y-l.y},i.x*r.x+i.y*r.y);if(h<0){let t=-(.7*h);if(e.vel=d(e.vel,c(r,-t)),a.vel=d(a.vel,c(r,.2*t)),Math.abs(t)>40){let l=.25*Math.abs(t);if(Z(e,l,r),a.hp-=.6*l,a.hp<=0){K(a.pos),$(a);let e=W.indexOf(a);e>=0&&W.splice(e,1)}}}}}for(let t of W)t.pos=P(d(t.pos,c(t.vel,e))),t.angle+=t.spin*e;for(let t=q.length-1;t>=0;t--){let l=q[t];if(l.life-=e,l.spin+=e,l.pos=P(d(l.pos,c(l.vel,.98*e))),j.alive&&E(j.pos,l.pos)<(j.radius+l.radius)*(j.radius+l.radius)){"credits"===l.type&&(G.credits+=l.amount),"missiles"===l.type&&(j.missileAmmo+=l.amount),"shield"===l.type&&(j.shield=s(j.shield+l.amount,0,j.maxShield)),"repair"===l.type&&(j.hull=s(j.hull+l.amount,0,j.maxHull)),a.pickup(),q.splice(t,1);continue}l.life<=0&&q.splice(t,1)}for(let t=F.length-1;t>=0;t--){let l=F[t];l.life-=e,l.pos=P(d(l.pos,c(l.vel,e))),l.vel=c(l.vel,.98),l.life<=0&&F.splice(t,1)}for(let t of V)t.alive&&(t.shield=s(t.shield+t.shieldRegen*e,0,t.maxShield));let h=j.alive?j.pos:C.pos;C.pos.x=(.92*C.pos.x+.08*h.x)%6e3,C.pos.y=(.92*C.pos.y+.08*h.y)%6e3,C.shake>0&&(C.shake=Math.max(0,C.shake-20*e))}(h),function(){i.fillStyle="#0b0f13",i.fillRect(0,0,k,M);let e=i.createLinearGradient(0,0,0,M);for(let t of(e.addColorStop(0,"#0b0f13"),e.addColorStop(1,"#0a0d11"),i.fillStyle=e,i.fillRect(0,0,k,M),ef(i,z,.2,"rgba(200,220,255,0.8)"),ef(i,H,.5,"rgba(220,240,255,1)"),ef(i,O,.8,"white"),W))!function(e,t){let l=er(t.pos);e.save(),e.translate(l.x,l.y),e.rotate(t.angle);let i=t.shape.length;e.beginPath();for(let l=0;l<i;l++){let a=l/i*Math.PI*2,o=t.radius*t.shape[l],n=Math.cos(a)*o,s=Math.sin(a)*o;0===l?e.moveTo(n,s):e.lineTo(n,s)}e.closePath(),e.fillStyle="#202830",e.strokeStyle="#808890",e.lineWidth=1.5,e.fill(),e.stroke(),e.restore()}(i,t);for(let e of q){let t=er(e.pos);i.save(),i.translate(t.x,t.y),i.rotate(e.spin),i.fillStyle=e.color,i.strokeStyle="#ffffff88",i.lineWidth=1.2,i.beginPath(),i.moveTo(0,-e.radius),i.lineTo(e.radius,0),i.lineTo(0,e.radius),i.lineTo(-e.radius,0),i.closePath(),i.fill(),i.stroke(),i.restore()}for(let e of I){var t=i;let l=er(e.pos),a=Math.atan2(e.vel.y,e.vel.x);t.save(),t.translate(l.x,l.y),t.rotate(a),t.fillStyle="#f2f2f2",t.strokeStyle="player"===e.faction?"#ff66cc":"#ffaa66",t.lineWidth=1.5,t.beginPath(),t.moveTo(7,0),t.lineTo(-6,-3),t.lineTo(-6,3),t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.moveTo(-6,0),t.lineTo(-6-(2*Math.sin(30*e.trail)+8),0);let o=t.createLinearGradient(-6,0,-20,0);o.addColorStop(0,"player"===e.faction?"rgba(255,200,240,0.8)":"rgba(255,200,160,0.8)"),o.addColorStop(1,"rgba(255,120,40,0)"),t.strokeStyle=o,t.stroke(),t.restore()}for(let e of U){var l=i;let t=er(e.pos),a=Math.atan2(e.vel.y,e.vel.x);l.save(),l.translate(t.x,t.y),l.rotate(a),l.strokeStyle=e.color,l.globalAlpha=s(e.life+.2,0,1),l.lineWidth=2,l.beginPath(),l.moveTo(-6,0),l.lineTo(6,0),l.stroke(),l.globalAlpha=1,l.restore()}for(let e of V)e.alive&&function(e,t){let l=er(t.pos);if(e.save(),e.translate(l.x,l.y),e.rotate(t.angle),t.shield>0&&t.alive){let l=.15+.15*(t.shield/t.maxShield);e.beginPath(),e.arc(0,0,t.radius+6,0,2*Math.PI),e.strokeStyle="rgba(120,220,255,".concat(l.toFixed(3),")"),e.lineWidth=2,e.stroke()}let i=t.heat;if(i>.01){e.beginPath(),e.moveTo(-t.radius-2,0),e.lineTo(-t.radius-8-14*i,-5),e.lineTo(-t.radius-8-14*i,5),e.closePath();let l=e.createLinearGradient(-t.radius-2,0,-t.radius-14-14*i,0);l.addColorStop(0,"rgba(255,220,120,0.9)"),l.addColorStop(1,"rgba(255,120,40,0.2)"),e.fillStyle=l,e.fill()}e.lineJoin="round",e.lineCap="round",e.lineWidth=2;let a=t.color;if(e.strokeStyle=a,e.fillStyle="#0b0f13","KESTREL"===t.model?(e.beginPath(),e.moveTo(t.radius+4,0),e.lineTo(-t.radius+2,-10),e.lineTo(-t.radius+2,-4),e.lineTo(-t.radius-2,-2),e.lineTo(-t.radius-2,2),e.lineTo(-t.radius+2,4),e.lineTo(-t.radius+2,10),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.ellipse(.3*t.radius,0,6,4,0,0,2*Math.PI),e.fillStyle="rgba(110,240,255,0.35)",e.fill()):"VULTURE"===t.model?(e.beginPath(),e.moveTo(t.radius+6,-4),e.lineTo(.2*t.radius,-10),e.lineTo(-t.radius+2,-9),e.lineTo(-t.radius+2,-3),e.lineTo(.2*t.radius,-6),e.lineTo(t.radius+6,-4),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.moveTo(t.radius+6,4),e.lineTo(.2*t.radius,10),e.lineTo(-t.radius+2,9),e.lineTo(-t.radius+2,3),e.lineTo(.2*t.radius,6),e.lineTo(t.radius+6,4),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.rect(-(.6*t.radius),-6,.8*t.radius,12),e.fill(),e.stroke()):"WASP"===t.model&&(e.beginPath(),e.moveTo(t.radius+5,0),e.lineTo(0,-t.radius),e.lineTo(-t.radius-5,0),e.lineTo(0,t.radius),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.moveTo(-2,-(.8*t.radius)),e.lineTo(-(.2*t.radius),0),e.lineTo(-2,.8*t.radius),e.strokeStyle=a+"aa",e.stroke()),"pirate"===t.faction){let l=Math.max(0,(t.hull+t.shield)/(t.maxHull+t.maxShield));e.save(),e.rotate(-t.angle),e.translate(0,t.radius+12),e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(-14,0,28,3),e.fillStyle="rgba(255,100,100,0.8)",e.fillRect(-14,0,28*l,3),e.restore()}e.restore()}(i,e);if(j.alive){let e=ee(j,800);if(e){let t=er(e.pos);i.save(),i.strokeStyle="#ff66cc",i.lineWidth=1.5;let l=e.radius+10;i.beginPath(),i.moveTo(t.x-l,t.y-l+8),i.lineTo(t.x-l,t.y-l),i.lineTo(t.x-l+8,t.y-l),i.moveTo(t.x+l,t.y-l+8),i.lineTo(t.x+l,t.y-l),i.lineTo(t.x+l-8,t.y-l),i.moveTo(t.x-l,t.y+l-8),i.lineTo(t.x-l,t.y+l),i.lineTo(t.x-l+8,t.y+l),i.moveTo(t.x+l,t.y+l-8),i.lineTo(t.x+l,t.y+l),i.lineTo(t.x+l-8,t.y+l),i.stroke(),i.restore()}}for(let e of F){var a=i;let t=er(e.pos),l=s(e.life/e.maxLife,0,1);a.save(),a.globalAlpha=e.fade?l:1,a.fillStyle=e.color,a.beginPath(),a.arc(t.x,t.y,e.size,0,2*Math.PI),a.fill(),a.globalAlpha=1,a.restore()}!function(e){e.save(),e.fillStyle="rgba(0,0,0,0.35)",e.fillRect(10,10,260,86),e.fillStyle="#cde8ff",e.font="14px monospace",e.textBaseline="top",e.fillText("Score: ".concat(G.score),20,16),e.fillText("Credits: ".concat(G.credits),20,34),e.fillText("Missiles: ".concat(j.missileAmmo),20,52),e.fillText("Streak: ".concat(G.killStreak," (Best ").concat(G.bestStreak,")"),20,70),e.fillStyle="rgba(0,0,0,0.35)",e.fillRect(288,18,224,44),e.fillStyle="#8cf";let t=j.shield/j.maxShield;e.fillRect(290,20,220*t,16),e.strokeStyle="#cde8ff",e.strokeRect(290,20,220,16),e.fillStyle="#f88";let l=j.hull/j.maxHull;e.fillRect(290,40,220*l,16),e.strokeStyle="#cde8ff",e.strokeRect(290,40,220,16),e.fillStyle="#cde8ff",e.font="12px monospace",e.fillText("Shield",294,22),e.fillText("Hull",294,42);let i=k-130,a=M-130;function o(t,l){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=R(t.x,j.pos.x,6e3),s=R(t.y,j.pos.y,6e3),r=i+60+.06*n,f=a+60+.06*s;Math.hypot(r-(i+60),f-(a+60))<=60-o&&(e.fillStyle=l,e.beginPath(),e.arc(r,f,o,0,2*Math.PI),e.fill())}for(let t of(e.strokeStyle="rgba(200,230,255,0.5)",e.fillStyle="rgba(10,15,20,0.6)",e.lineWidth=1.2,e.beginPath(),e.arc(i+60,a+60,60,0,2*Math.PI),e.fill(),e.stroke(),W))o(t.pos,"#99a4b0",2);for(let e of V)e.alive&&o(e.pos,"player"===e.faction?"#6cf3ff":"#ff7a50",3);e.restore()}(i),g&&(i.save(),i.fillStyle="rgba(0,0,0,0.6)",i.fillRect(0,0,k,M),i.fillStyle="#cde8ff",i.font="24px monospace",i.textAlign="center",i.fillText("Paused",k/2,M/2-50),i.font="14px monospace",i.fillText("Press P or Esc to resume",k/2,M/2-20),i.restore()),!x||g||G.gameOver||function(e){let t=k/2-260,l=M-220-20;e.save(),e.fillStyle="rgba(5,10,14,0.75)",e.fillRect(t,l,520,220),e.strokeStyle="rgba(160,200,240,0.8)",e.strokeRect(t,l,520,220),e.fillStyle="#cde8ff",e.font="14px monospace";let i=l+14;for(let l of["Controls:","W/S: Thrust / Brake","A/D: Rotate     Q/E: Strafe","Shift: Boost","Space: Fire lasers    F: Fire homing missile","M: Toggle mouse-aim assist   P/Esc: Pause","R: Respawn (after death)   H: Toggle help","","Tip: Lead targets, kite pirates, and snag pickups!"])e.fillText(l,t+14,i),i+=18;e.restore()}(i),G.gameOver&&(i.save(),i.fillStyle="rgba(0,0,0,0.6)",i.fillRect(0,0,k,M),i.fillStyle="#cde8ff",i.textAlign="center",i.font="26px monospace",i.fillText("Ship Destroyed",M/2,M/2-80),i.font="18px monospace",i.fillText("Final Score: ".concat(G.score),k/2,M/2-40),i.fillText("Best Streak: ".concat(G.bestStreak),k/2,M/2-16),i.fillText("Press R to Respawn",k/2,M/2+20),i.restore())}()}),()=>{cancelAnimationFrame(es),window.removeEventListener("resize",b),window.removeEventListener("keydown",et),window.removeEventListener("keyup",el),window.removeEventListener("mousemove",ei),window.removeEventListener("mousedown",ea),window.removeEventListener("mouseup",eo)}},[t,g]),(0,i.jsxs)("div",{style:{position:"fixed",inset:0,background:"#0b0f13",overflow:"hidden",userSelect:"none",touchAction:"none"},onClick:async()=>{t||(await T.current.resume(),l(!0))},children:[(0,i.jsx)("canvas",{ref:e}),!t&&(0,i.jsxs)("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(#0b0f13, #0a0d11)",color:"#cde8ff",flexDirection:"column",gap:12},children:[(0,i.jsx)("div",{style:{fontFamily:"monospace",fontSize:28},children:"EV: Pocket Skirmish"}),(0,i.jsx)("div",{style:{fontFamily:"monospace",fontSize:14,opacity:.8},children:"Click to start. Then use W/A/S/D, Q/E, Space, F. Press H for help."}),(0,i.jsx)("div",{style:{fontFamily:"monospace",fontSize:13,opacity:.7,marginTop:8,padding:"6px 10px",border:"1px solid #2a3a44",borderRadius:6},children:"No downloads needed. All graphics and audio are generated."})]})]})}},6624:(e,t,l)=>{Promise.resolve().then(l.bind(l,1057))}},e=>{e.O(0,[441,964,358],()=>e(e.s=6624)),_N_E=e.O()}]);